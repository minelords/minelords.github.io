---
layout: post
title: php序列化
categories: [web,php,serialize]
---

# serialize and unserialize

## 概念

```
PHP程序执行结束以后会将文件中的变量和内容释放掉， 如果一个程序想要的调用之前程序的变量，但是之前的程序已经执行完毕，所有的变量和内容都被释放，那该如何操作呢？这时  候就可以通过序列化和反序列化保存程序中的对象，给其他程序使用。 php序列化可以将对象转换成字符串，但只序列化属性，不序列化方法。
```

## 例

```php
    <?php
        class TEST{
            public $a="public";  
            private $b="private";  
            protected $c="protected";  
            static $d="static";  
        }

        $aaa=new TEST();  
        echo serialize($aaa);  

    ?>

    输出：O:4:"TEST":3{s:1:"a";s:6:"public";s:7:"TESTb";s:7:"private";s:4:"*c";s:9:"protected";}  

    解释：  
    O:表示这是一个对象  
    4:对象的名称TEST有4个字符  
    TEST:对象的名称  
    3:对象属性的个数（不包含static）  

    s:变量名数据类型为string  
    1:变量a的名字长度   
    a:变量名称  
    s:变量值的数据类型  
    6:变量值的长度  
    public:变量的值  
```

---

## 常见的magic函数  

> `__sleep()`    serialize() 函数会检查类中是否存在一个__sleep()方法，如果存在，该方法会先被调用，然后才执行序列化操作  
`__wakeup()`    unserialize() 会检查是否存在一个__wakeup()方法。如果存在，则会先调用该方法。影响版本：PHP5 < 5.6.25 ，PHP7 < 7.0.10  
当在反序列化字符串当中如果表示属性个数的值大于其真实值，则跳过该魔术方法

## 其他常见的magic函数

![magic](/img/magic.png)


## 例：[NISACTF 2022]popchains
