---

catalog: true
tags:
    web
    md5
---

# md5总结

> 弱类型比较产生的漏洞
强类型比较产生的漏洞
MD5碰撞
构造攻击语句

***

## 弱比较

> `v1!=v2,md5(v1)==md5(v2)`

> 以0e开头会被php判定为0

```php
var_dump('1' == 1); //true
var_dump('1a' == 1);  //true
var_dump('1a1' == 1);  //true
var_dump('a123' == 0);  //true
var_dump('1aa' == 0);  //false
```
>让一个数MD5加密后还是和加密前相等，这也就在网上找到了这个的数`0e215962017`

### 0e大法

> |原字符串|0e开头的md5|
> |--|--|
> |QNKCDZO|0e830400451993494058024219903391|
> |240610708|0e462097431906509019562988736854|
> |s878926199a|0e545993274517709034328855841020|
> |s155964671a|0e342768416822451524974117254469|
> |s214587387a|0e848240448830537924465865611904|
> |s214587387a|0e848240448830537924465865611904|
> |s878926199a|0e545993274517709034328855841020|
> |s1091221200a|0e940624217856561557816327384675|
> |s1885207154a|0e509367213418206700842008763514|
> |s1502113478a|0e861580163291561247404381396064|

## 强比较

```
md5($v1)===md5($v2)
数组绕过：A[]=a&B[]=b
```

***

## MD5构造攻击语句

### 构造sql语句

```
构造or语句绕过：
md5(ffifdyop,true)='or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c
md5(129581926211651571912466741651878684928,true)=\x06\xdaT0D\x9f\x8fo#\xdf\xc1’or’8
```

```sql
select * from 'admin' where password=md5($pass,true)
ffifdyop
这个点的原理是 ffifdyop 这个字符串被 md5 哈希了之后  
会变成 276f722736c95d99e921722cf9ed621c (对应ascii字符串'or'6É]™é!r,ùíb)，  
这个字符串前几位刚好是 ‘ or ‘6， 而 Mysql 刚好又会吧 hex 转成 ascii 解释，  
因此拼接之后的形式是select * from ‘admin’ where password=’’ or ‘6xxxxx’。  
等价于 or 一个永真式，因此相当于万能密码，可以绕过md5()函数
```
